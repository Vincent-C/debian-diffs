From 19389867e134b069bb4462c0a930461a3dc6c2b9 Mon Sep 17 00:00:00 2001
From: Werner Lemberg <wl@gnu.org>
Date: Mon, 24 Nov 2014 09:31:32 +0100
Subject: [sfnt] Fix Savannah bug #43672. CVE-2014-9658

* src/sfnt/ttkern.c (tt_face_load_kern): Use correct value for
minimum table length test.

(cherry picked from commit f70d9342e65cd2cb44e9f26b6d7edeedf191fc6c)
---
 freetype-2.5.2/src/sfnt/ttkern.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git freetype-2.5.2/src/sfnt/ttkern.c freetype-2.5.2/src/sfnt/ttkern.c
index 32c4008..455e7b5 100644
--- freetype-2.5.2/src/sfnt/ttkern.c
+++ freetype-2.5.2/src/sfnt/ttkern.c
@@ -99,7 +99,7 @@
       length   = FT_NEXT_USHORT( p );
       coverage = FT_NEXT_USHORT( p );
 
-      if ( length <= 6 )
+      if ( length <= 6 + 8 )
         break;
 
       p_next += length;
-- 
2.1.4

