From 31fddea8aa48f4c3fed12ff985da0a24b5561f46 Mon Sep 17 00:00:00 2001
From: Werner Lemberg <wl@gnu.org>
Date: Fri, 21 Nov 2014 22:19:28 +0100
Subject: [type1, type42] Fix Savannah bug #43655. CVE-2014-9664

* src/type1/t1load.c (parse_charstrings), src/type42/t42parse.c
(t42_parse_charstrings): Fix boundary testing.

(cherry picked from commit dd89710f0f643eb0f99a3830e0712d26c7642acd)
---
 freetype-2.5.2/src/type1/t1load.c    | 2 +-
 freetype-2.5.2/src/type42/t42parse.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git freetype-2.5.2/src/type1/t1load.c freetype-2.5.2/src/type1/t1load.c
index 4b5026b..fca3279 100644
--- freetype-2.5.2/src/type1/t1load.c
+++ freetype-2.5.2/src/type1/t1load.c
@@ -1599,7 +1599,7 @@
         FT_PtrDist  len;
 
 
-        if ( cur + 1 >= limit )
+        if ( cur + 2 >= limit )
         {
           error = FT_THROW( Invalid_File_Format );
           goto Fail;
diff --git freetype-2.5.2/src/type42/t42parse.c freetype-2.5.2/src/type42/t42parse.c
index 3cdd8a1..0b3e0c6 100644
--- freetype-2.5.2/src/type42/t42parse.c
+++ freetype-2.5.2/src/type42/t42parse.c
@@ -832,7 +832,7 @@
         FT_PtrDist  len;
 
 
-        if ( cur + 1 >= limit )
+        if ( cur + 2 >= limit )
         {
           FT_ERROR(( "t42_parse_charstrings: out of bounds\n" ));
           error = FT_THROW( Invalid_File_Format );
-- 
2.1.4

